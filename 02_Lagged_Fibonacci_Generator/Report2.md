# Report2

> Rainzor

### 1 Question

​	用 16807 产生器测试随机数序列中满足关系 $X_{n-1}>X_{n+1} >X_n$ 的比重。讨论 Fibonacci 延迟产生器中出现这种关系的比重。

### 2 Algorithm

#### 2.1 16807随机数生成器

​	Schrage 方法主要解决的是线性同余法产生随机数时可能出现的越界问题。其递推关系为:
$$
I_{n+1}=\left\{\begin{aligned}&a(I_n~mod~q)-r[I_n/q],&if~I_{n+1}>0\\&a(I_n~mod~q)-r[I_n/q]+m,&otherwise\end{aligned}\right.
$$
​	实际计算中取q=127773， r=2836，a=16807，m=2147483647。当提供了第一个小于 m 的初始值 $I_0$ 之后，就可以 根据次递推公式得到后续的伪随机数。

​	代码实现在 `Schrage_16807.py`中封装

#### 2.2 Fibonacci延迟产生器

​	Fibonacci 延迟产生器的思想是利用序列中的两个整数进行操作后得到后续的整 数。即$𝐼𝑛 = (𝐼_{𝑛−𝑝} \otimes 𝐼_{𝑛−𝑞})𝑚𝑜𝑑~𝑚$。其中操作符可以为：+，-，*等。本实验用的是带载减法产生器。其递推关系为
$$
\begin{aligned}
t_n&=I_{n-22}-I_{n-43}-C\\
C&=0 ,I_n=t_n,&if~~t_n\ge0\\
C&=1 ,I_n=t_n+(2^{23}-5),&if~~t_n<0
\end{aligned}
$$
​	在具体生成随机数的时候，首先先指定一个初始值，然后用 16807 产生器产生前 43个随机数，然后再用 Fibonacci 产生器产生剩余的随机数序列。

​	代码实现在 `LaggedFibonacci`类中。

### 2. Experiment 

​	实验结果如下，每组有1e5个数据点

![](.\16807&Fibonacci比较.png)

<center><p>图1：随机数序列中满足关系 Xn-1>Xn+1 >Xn的比重


分析：

​	在完全随机的理想情况下，假设a,b,c是相互独立且都是均匀分布在[0,1]的随机数，那么
$$
P(a>b\&b>c)=\int_0^1da\int^a_0db\int_0^bdc=\frac{1}{6}
$$
​	理想比重应当是 $\frac{1}{6}$ ，而从整体实验结果来看，两种生成器的计算结果都比较接近理想值，但都存在一定偏差。而且可以看到，实验结果受到初始值影响较大。

### 3.Summary

​	两种产生器所生成的随机数组里面满足 $X_{n-1}>X_{n+1} >X_n$  比重都接近于 1/6。两种生成器的计算结果都比较接近理想值，结果与初始条件选择有关。

​	本实验掌握了另一种随机数产生器的原理，并学习了一种新的衡量伪随机数产生器优劣的方式。
